<h2>Room</h2>

<div *ngIf="!connected">
  <input placeholder="Your name" [(ngModel)]="userName">
  <button class="btn btn-primary" (click)="onClickJoin()">Join</button>
</div>
<div *ngIf="connected">
  <h3>Players</h3>
  <h3>{{user.name}} / {{user.id}} -- {{room?.game?.phase}} -- round {{room?.game?.rounds[room?.game?.rounds?.length-1]?.roundNumber}}</h3>
  <ul *ngIf="!room.game">
    <li *ngFor="let user of room?.users">{{user|json}}
    </li>
  </ul>
  <ul *ngIf="room.game">
    <li *ngFor="let player of room.game.players">
      {{player.name}} -
      <button *ngIf="room?.game?.phase == 'NOMINATING_CHANCELLOR' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president && user.id!=player.id" (click)="onNominateChancellor(player.id)">NominateChancellor</button>
      <button  *ngIf="room?.game?.phase == 'PRESIDENT_EXECUTIVE_POWER' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president && user.id!=player.id" (click)="onInvestigateLoyalty(player.id)">InvestigateLoyalty</button>
      <button  *ngIf="room?.game?.phase == 'PRESIDENT_EXECUTIVE_POWER' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president && user.id!=player.id" (click)="onCallSpecialElection(player.id)">CallSpecialElection</button>
      <button  *ngIf="room?.game?.phase == 'PRESIDENT_EXECUTIVE_POWER' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president && user.id!=player.id" (click)="onExecution(player.id)">Execution</button>
    </li>
  </ul>

  <h3>Game data</h3>
  <div>{{room.game | json}}</div>

  <ng-container *ngIf="lastError">
    <h3>Error</h3>
    <div>{{lastError.code}} / {{lastError?.data}}</div>
  </ng-container>

  <h3>Actions</h3>
  <button (click)="onPingClicked()">Ping</button>
  <button (click)="onGetRoomStateClicked()">Get Room State</button>
  <button *ngIf="room?.game?.phase == null && room.users.length > 4" (click)="onStartGameClicked()">StartGame</button>
  <button *ngIf="room?.game?.phase == 'VOTING_LEADERSHIP'" (click)="onVoteLeadership(Vote.YES)">VoteLeadership YES</button>
  <button *ngIf="room?.game?.phase == 'VOTING_LEADERSHIP'" (click)="onVoteLeadership(Vote.NO)">VoteLeadership NO</button>
  <button *ngIf="room?.game?.phase == 'PRESIDENT_DISCARDS_POLICY_TILE' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president" (click)="onDiscardPolicyTile(PolicyTile.LIBERAL)">discard liberal policy</button>
  <button *ngIf="room?.game?.phase == 'PRESIDENT_DISCARDS_POLICY_TILE' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president" (click)="onDiscardPolicyTile(PolicyTile.FASCIST)">discard fascist policy</button>
  <button *ngIf="room?.game?.phase == 'CHANCELLOR_DISCARDS_POLICY_TILE' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].chancellor" (click)="onDiscardPolicyTile(PolicyTile.LIBERAL)">discard liberal policy</button>
  <button *ngIf="room?.game?.phase == 'CHANCELLOR_DISCARDS_POLICY_TILE' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].chancellor" (click)="onDiscardPolicyTile(PolicyTile.FASCIST)">discard fascist policy</button>
  <button *ngIf="room?.game?.phase == 'CHANCELLOR_DISCARDS_POLICY_TILE' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].chancellor" (click)="onRequestVeto()">RequestVeto</button>
  <button *ngIf="room?.game?.phase == 'VETO_REQUESTED' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president" (click)="onConfirmVeto()">ConfirmVeto</button>
  <button *ngIf="room?.game?.phase == 'VETO_REQUESTED' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president" (click)="onDenyVeto()">DenyVeto</button>
  <button *ngIf="room?.game?.phase == 'PRESIDENT_EXECUTIVE_POWER' && user.id == room?.game?.rounds[room?.game?.rounds.length-1].president" (click)="onPolicyPeek()">PolicyPeek</button>

</div>
